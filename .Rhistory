ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "NMDS graph facet wrapped with location",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.subtitle = element_text(hjust = 0.1), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "NMDS graph facet wrapped with location",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.subtitle = element_text(hjust = 0.4), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "NMDS graph facet wrapped with location",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.4), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "NMDS graph facet wrapped with location",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "2016 NMDS graph facet wrapped with location. Shape is determined by location and salinity is marked by a blue color scale",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "2016 NMDS graph facet wrapped with location. Shape is determined by location and salinity is marked by a blue color scaleddddddddddddddddddddddddddddddddddd",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "2016 NMDS graph facet wrapped with location. Shape determined by location and salinity by a blue color scale",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "2016 NMDS graph",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
ds.16 = ds.16 %>%
mutate(loc_spaced = NaN)
for(i in 1:length(ds.16$loc_spaced)){
if(ds.16$Location[i]== "ShallowRiver"){ds.16$loc_spaced[i]<- "Shallow River"}else{if(ds.16$Location[i]== "LowerBasin"){ds.16$loc_spaced[i]<- "Lower Basin"} else{ds.16$loc_spaced[i]<- "Upper Basin"}}
}
ggplot(ds.16) +
geom_point(aes(NMDS1, NMDS2,  shape= as.factor(loc_spaced),  color= Sal), size =3) + facet_wrap(~loc_spaced) + theme_bw() +  labs(title = "2016 Narrow River NMDS Plot",
caption = "",                                                                                           subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
library(kableExtra)
plot_bar(narrow.phy, fill ="class") +
geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.15, fill ="class") +geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.16, fill ="class") + geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
View(narrow.phy)
View(asvs_taxonomy)
plot_bar(narrow.phy, fill ="phylum") +
geom_bar(aes(color=phylum, fill=phylum), stat="identity", position="stack")
plot_bar(narrow.phy, fill ="phylum") +
geom_bar(aes(color=phylum, fill=phylum), stat="identity", position="stack")
plot_bar(phy.15, fill ="phylum") +geom_bar(aes(color=phylum, fill=phylum), stat="identity", position="stack")
plot_bar(phy.16, fill ="phylum") + geom_bar(aes(color=phylum, fill=phylum), stat="identity", position="stack")
plot_bar(narrow.phy, fill ="class") +
geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
narrow.diss = phyloseq::distance(phy.16, method = "bray")
narrow.perm = adonis2(narrow.diss~ sample_data(phy.16)$Depth+sample_data(phy.16)$Temp+sample_data(phy.16)$LocnDescriptor+sample_data(phy.16)$Sal, data=Metadata )
narrow.aov = tibble(narrow.perm)
library(kableExtra)
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 ANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results havve a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")
View(Metadata)
defaultW <- getOption("warn")
options(warn = -1)
YOUR CODE
options(warn = defaultW)
defaultW <- getOption("warn")
options(warn = -1)
YOUR CODE
options(warn = defaultW)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
library(kableExtra)
make_metagenomeSeq = function(physeq) {
require("metagenomeSeq")
require("phyloseq")
# Enforce orientation
if (!taxa_are_rows(physeq)) {
physeq <- t(physeq)}
OTU = as(otu_table(physeq), "matrix")
# Convert sample_data to AnnotatedDataFrame
ADF = AnnotatedDataFrame(data.frame(sample_data(physeq)))
# define dummy 'feature' data for OTUs, using their name Helps with
# extraction and relating to taxonomy later on.
TDF = AnnotatedDataFrame(data.frame(OTUname = taxa_names(physeq), row.names = taxa_names(physeq)))
# Create the metagenomeSeq object
MGS = newMRexperiment(counts = OTU, phenoData = ADF, featureData = TDF)
# Trigger metagenomeSeq to calculate its Cumulative Sum scaling factor.
MGS = cumNorm(MGS)
return(MGS)
}
View(asvs_counts)
meta.narrow.all<-meta.narrow
narrow.css.all <-MRcounts(meta.narrow.all, norm= TRUE, log= TRUE)
narrow.csst.all <- t(narrow.css.all)
narrow.dist.all <- vegdist(narrow.csst.all, method= "bray", binary=FALSE, diag=TRUE, upper=TRUE)
set.seed(209)
narrow.mds.all <- metaMDS(narrow.dist.all, distance = "bray", k=2, trymax = 1000)
invisible(narrow.mds.all <- metaMDS(narrow.dist.all, distance = "bray", k=2, trymax = 1000))
?invisible
invisible(narrow.mds.all) <- metaMDS(narrow.dist.all, distance = "bray", k=2, trymax = 1000)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
knitr::opts_chunk$set(echo = T,
results = "hide")
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
library(kableExtra)
meta.narrow.all<-meta.narrow
narrow.css.all <-MRcounts(meta.narrow.all, norm= TRUE, log= TRUE)
narrow.csst.all <- t(narrow.css.all)
narrow.dist.all <- vegdist(narrow.csst.all, method= "bray", binary=FALSE, diag=TRUE, upper=TRUE)
set.seed(209)
narrow.mds.all <- metaMDS(narrow.dist.all, distance = "bray", k=2, trymax = 1000)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
library(kableExtra)
meta.narrow.all<-meta.narrow
narrow.css.all <-MRcounts(meta.narrow.all, norm= TRUE, log= TRUE)
narrow.csst.all <- t(narrow.css.all)
narrow.dist.all <- vegdist(narrow.csst.all, method= "bray", binary=FALSE, diag=TRUE, upper=TRUE)
set.seed(209)
narrow.mds.all <- metaMDS(narrow.dist.all, distance = "bray", k=2, trymax = 1000)
invisible({capture.output({
meta.narrow.all<-meta.narrow
narrow.css.all <-MRcounts(meta.narrow.all, norm= TRUE, log= TRUE)
narrow.csst.all <- t(narrow.css.all)
narrow.dist.all <- vegdist(narrow.csst.all, method= "bray", binary=FALSE, diag=TRUE, upper=TRUE)
set.seed(209)
narrow.mds.all <- metaMDS(narrow.dist.all, distance = "bray", k=2, trymax = 1000)
})})
narrow.diss = phyloseq::distance(phy.16, method = "bray")
narrow.perm = adonis2(narrow.diss~ sample_data(phy.16)$Depth+sample_data(phy.16)$Temp+sample_data(phy.16)$LocnDescriptor+sample_data(phy.16)$Sal, data=Metadata )
narrow.aov = tibble(narrow.perm)
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 ANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results havve a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")
plot_bar(phy.15, fill ="class") +geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.16, fill ="class") + geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.15, fill ="class") +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",labs(title = "2016 Narrow River NMDS Plot",
caption = "",    subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") +
theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5))
)
plot_bar(phy.16, fill ="class") + geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.15, fill ="class") +ggtitle("Plot of length \n by dose") +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class") + geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class") + geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class") + geom_bar(aes(color=class, fill=class), stat="identity", position="stack")
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +labs(title = "2015 Samples",
caption = "",    subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") + +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +labs(title = "2015 Samples",
caption = "",    subtitle = "",
tag = "Figure 2",
x = "NMDS1",
y = "NMDS2",
shape = "Location",
color = "Salinity") + +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) labs(title = "2015 Samples",
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag=Figure 1) + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(2:5:6,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(2,5,6,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")%>%
row_spec(2,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results in red have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")%>%
row_spec(2,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results in red have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")%>%
row_spec(2,color = "black")
dt <- narrow.perm
rownames(dt) <- c("Depth", "Temperature", "Location", "Salinity", "Residuals", "Total")
colnames(dt) <- c("Degrees of Freedom","Sum of Square Roots","R-squared","f-value","p-value")
kbl(dt, format = "html") %>%
kable_styling(bootstrap_options = c("bordered","striped",  "hover")) %>%
add_header_above(c( "2016 PERMANOVA Table" = 6)) %>%
footnote(number = c("ANOVA table for Depth, Temperature, Location and Salinity from 2016 samples. All results in red have a p-value less than 0.05, showing statistical significance.")) %>%
column_spec(1, bold = T) %>%
column_spec(6, color = "red") %>%
row_spec(5:6,color = "black")%>%
row_spec(2,color = "black")
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
grid.arrange(p1, p2, ncol = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2)
?grid.arrange
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 3)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 4)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 1)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 0)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, nrow=2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, nrow(2))
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, nrow(2))
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 1, nrow = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 1, nrow = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2, nrow = 2)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, ncol = 2, nrow = 1)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
grid.arrange(p1, p2, nrow = 2)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
library(kableExtra)
library(cowplot)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
plot_grid(p1, p2, labels = "AUTO")
plot_grid(p1, p2, labels = "AUTO")
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)-> p1
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",) -> p2
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(phyloseq)
library(metagenomeSeq)
library(vegan)
library(here)
library(janitor)
library(gridExtra)
library(kableExtra)
plot_bar(phy.15, fill ="class") +ggtitle("2015 Samples") +  labs(tag="Figure 1") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
plot_bar(phy.16, fill ="class")  +ggtitle("2016 Samples") +  labs(tag="Figure 2") + theme( plot.caption = element_text(hjust = 0.5), plot.title = element_text(hjust = 0.5)) +geom_bar(aes(color=class, fill=class), stat="identity", position="stack",)
